{"ast":null,"code":"var inherits = require('inherits');\nvar Readable = require('readable-stream').Readable;\nvar extend = require('xtend');\nmodule.exports = ReadStream;\ninherits(ReadStream, Readable);\nfunction ReadStream(iterator, options) {\n  if (!(this instanceof ReadStream)) return new ReadStream(iterator, options);\n  options = options || {};\n  Readable.call(this, extend(options, {\n    objectMode: true\n  }));\n  this._iterator = iterator;\n  this._options = options;\n  this.on('end', this.destroy.bind(this, null, null));\n}\nReadStream.prototype._read = function () {\n  var self = this;\n  var options = this._options;\n  if (this.destroyed) return;\n  this._iterator.next(function (err, key, value) {\n    if (self.destroyed) return;\n    if (err) return self.destroy(err);\n    if (key === undefined && value === undefined) {\n      self.push(null);\n    } else if (options.keys !== false && options.values === false) {\n      self.push(key);\n    } else if (options.keys === false && options.values !== false) {\n      self.push(value);\n    } else {\n      self.push({\n        key: key,\n        value: value\n      });\n    }\n  });\n};\nReadStream.prototype._destroy = function (err, callback) {\n  var self = this;\n  this._iterator.end(function (err2) {\n    callback(err || err2);\n\n    // TODO when the next readable-stream (mirroring node v10) is out:\n    // remove this. Since nodejs/node#19836, streams always emit close.\n    process.nextTick(function () {\n      self.emit('close');\n    });\n  });\n};","map":null,"metadata":{},"sourceType":"script"}